<script id="chart-script">
  const dataPayment = {
    labels: [{% for key, value in payment_stats.items %}'{{key}}', {% endfor %}],
    datasets: [{
      label: 'Payments',
      data: [{% for key, value in payment_stats.items %}{{ value }}, {% endfor %}],
      // ids: [{% for key, value in payment_stats.items %}{{ value.id }}, {% endfor %}],
      // backgroundColor: ['#729ece', '#ff9e4a', '#67bf5c', '#ed665d', '#ad8bc9', '#a8786e', '#ed97ca', '#a2a2a2', '#cdcc5d', '#6dccda'],
      // hoverOffset: 4
      options: {
        scales: {
          xAxes: [{
            type: 'time',
            distribution: 'linear'
          }],
          title: {
            display: false,
          }
        }
      }
    }]
  };

  const configPayment = {
    type: 'line',
    data: dataPayment,
  };

  const paymentsCtx = document.querySelector('#paymentsChart');
  const paymentsChart = new Chart(paymentsCtx, configPayment);
  // const charts = [expensesChart, incomesChart];
  // const canvases = document.querySelectorAll('canvas');

  // canvases.forEach(canvas => {
  //   canvas.addEventListener('click', canvasEventHandler)
  // });

  // function canvasEventHandler(event) {
  //   charts.forEach(chart => {
  //     if (chart.canvas == event.currentTarget) {
  //       let activePoints = chart.getElementsAtEventForMode(event, 'nearest', { intersect: true }, true);
  //       const pointIndex = activePoints[0].index;
  //       let categoryIndex = chart.config.data.datasets[0].ids[pointIndex];
  //       let categoryLabel = chart.config.data.labels[pointIndex]
  //       getSubcategoryChartData(categoryIndex).then(data => {
  //         modalChart.data.labels = data.labels;
  //         modalChart.data.datasets[0].data = data.data;
  //         modalChart.options.plugins.title.text = categoryLabel + ' & subcategories';
  //         modalChart.update();
  //         $('#chartModal').modal('toggle');
  //       });
  //     };
  //   });
  // };

  // function getSubcategoryChartData(categoryIndex) {
  //   const transactionsDiv = document.querySelector('#transactions-table');
  //   const time = transactionsDiv.dataset.time;
  //   let url = window.location.pathname + '/ajax' + `/${categoryIndex}` + `?time=${time}`;
  //   return fetch(url, {
  //     method: 'GET',
  //     headers: {},
  //   }).then(response => {
  //     return response.json()
  //   }).then(data => {
  //     return data;
  //   });
  // };
</script>